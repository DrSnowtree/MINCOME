install.packages("dfoptim")
library("dfoptim")
aa <- allFit(m2)
install.packages("nloptr")
setwd("W:/WU/Projekte/mincome/Mincome/Data")
library("compareGroups")
library("data.table")
library("gtools")
library("haven")
library("dplyr")
library("tidyr")
library("tidyverse")
library("lubridate")
library("data.table")
library("foreign")
library("haven")
library("quantmod")
library("zoo")
library("plm")
library("gplots")
library("stargazer")
library("lfe")
library("Hmisc")
library("readxl")
library("naniar")
library("strex")
library(devtools)
library(survival)
library(pltesim)
library(informR)
library(frailtypack)
library("logistf")
library("brglm")
library("lme4")
library("optimx")
library("numDeriv")
library("RCurl")
library("dfoptim")
library("nloptr")
afurl <- "https://raw.githubusercontent.com/lme4/lme4/master/misc/issues/allFit.R"
eval(parse(text=getURL(afurl)))
aa <- allFit(m2)
eval(parse(text=getURL(afurl)))
View(m2)
afurl <- "https://raw.githubusercontent.com/lme4/lme4/master/misc/issues/allFit.R"
eval(parse(text=getURL(afurl)))
aa <- allFit(m2)
afurl <- "https://raw.githubusercontent.com/lme4/lme4/master/misc/issues/allFit.R"
eval(parse(text=getURL(afurl)))
eval(parse(text=getURL(afurl)))
library("compareGroups")
library("data.table")
library("gtools")
library("haven")
library("dplyr")
library("tidyr")
library("tidyverse")
library("lubridate")
library("data.table")
library("foreign")
library("haven")
library("quantmod")
library("zoo")
library("plm")
library("gplots")
library("stargazer")
library("lfe")
library("Hmisc")
library("readxl")
library("naniar")
library("strex")
library(devtools)
library(survival)
library(pltesim)
library(informR)
library(frailtypack)
library("logistf")
library("brglm")
library("lme4")
library("optimx")
library("numDeriv")
library("RCurl")
library("dfoptim")
library("nloptr")
setwd("W:/WU/Projekte/mincome/Mincome/Data")
afurl <- "https://raw.githubusercontent.com/lme4/lme4/master/misc/issues/allFit.R"
eval(parse(text=getURL(afurl)))
aa <- allFit(m2)
#try lots of different optimizers
m4 <- update(m1_sc,start=ss,control=glmerControl(optimizer="nlminb",
optCtrl=list(maxfun=2e5)))
#try lots of different optimizers
m4 <- update(m1_sc,start=ss,control=glmerControl(optimizer="optimx.nlminb",
optCtrl=list(maxfun=2e5)))
optimx.nlminb
stargazer(m4)
stargazer(m3)
m1 <- glmer(formula = birth ~ factor(plan) + factor(age) + (1|OID) + factor(year)
+married,
family = binomial(link ="logit"), data = datapp)
stargazer(m1)
#rescale
length(getME(m1,"theta"))
numcols <- grep("^c\\.",names(datapp))
datapps <- datapp
datapps[,numcols] <- scale(datapps[,numcols])
m1_sc <- update(m1,data=datapps)
#check for singularity
tt <- getME(m1_sc,"theta")
ll <- getME(m1_sc,"lower")
min(tt[ll==0])
#no problem of singularity
#Double-checking gradient calculations, tolerance level typically set is 0.001
derivs1 <- m1_sc@optinfo$derivs
sc_grad1 <- with(derivs1,solve(Hessian,gradient))
max(abs(sc_grad1))
max(pmin(abs(sc_grad1),abs(derivs1$gradient)))
# second one is much smaller, but still larger than the tolerance level
dd <- update(m1_sc,devFunOnly=TRUE)
pars <- unlist(getME(m1_sc,c("theta","fixef")))
grad2 <- grad(dd,pars)
hess2 <- hessian(dd,pars)
sc_grad2 <- solve(hess2,grad2)
max(pmin(abs(sc_grad2),abs(grad2)))
#set the maximum repetiton higher
ss <- getME(m1_sc,c("theta","fixef"))
m2 <- update(m1_sc,start=ss,control=glmerControl(optCtrl=list(maxfun=2e4)))
stargazer(m2)
#try a different optimizer
m3 <- update(m1_sc,start=ss,control=glmerControl(optimizer="bobyqa",
optCtrl=list(maxfun=2e5)))
stargazer(m3)
m1 <- glmer(formula = birth ~ treated*experiment + factor(age) + (1|OID) + factor(year)
+ factor(j) + factor(j)*factor(age),
family = binomial(link ="logit"), data = datapp)
m1 <- glmer(formula = birth ~ treated*experiment + factor(age) + (1|OID) + factor(year)
+ factor(j),
family = binomial(link ="logit"), data = datapp)
stargazer(m1)
#remove the households where we have missing information about the length of previous marriage,
#and try with married dummy
datapp_rem <- datapp[-which(!is.na(datapp$datesepcl) | !is.na(datapp$datesepmrg)), ]
m2 <- glmer(formula = birth ~ treated*experiment + factor(age) + (1|OID) + factor(year)
+ factor(j) + married,
family = binomial(link ="logit"), data = datapp)
View(datapp_rem)
|datapp$year ==1937 | datapp$year == 1938 |datapp$year == 1939] <- "30s"
datapp$decade <- 0
datapp$decade[datapp$year == 1930  |datapp$year ==1931  |datapp$year ==1933
|datapp$year == 1934  | datapp$year ==1935 |datapp$year ==1936
|datapp$year ==1937 | datapp$year == 1938 |datapp$year == 1939] <- "30s"
datapp$decade[datapp$year == 1940  |datapp$year ==1941  |datapp$year ==1943
|datapp$year == 1944  | datapp$year ==1945 |datapp$year ==1946
|datapp$year ==1947 | datapp$year == 1948 |datapp$year == 1939] <- "40s"
datapp$decade[datapp$year == 1950  |datapp$year ==1951  |datapp$year ==1953
|datapp$year == 1954  | datapp$year ==1955 |datapp$year ==1956
|datapp$year ==1957 | datapp$year == 1958 |datapp$year == 1959] <- "50s"
datapp$decade[datapp$year == 1960  |datapp$year ==1961  |datapp$year ==1963
|datapp$year == 1964  | datapp$year ==1965 |datapp$year ==1966
|datapp$year ==1967 | datapp$year == 1968 |datapp$year == 1969] <- "60s"
datapp$decade[datapp$year == 1970  |datapp$year ==1971  |datapp$year ==1973
|datapp$year == 1974  | datapp$year ==1975 |datapp$year ==1976
|datapp$year ==1977] <- "70s"
stargazer(m2)
m2 <- glmer(formula = birth ~ treated*experiment + factor(age) + (1|OID) + factor(year)
+ factor(j) + married,
family = binomial(link ="logit"), data = datapp_rem)
#remove the households where we have missing information about the length of previous marriage,
#and try with married dummy
datapp_rem <- datapp[-which(!is.na(datapp$datesepcl) | !is.na(datapp$datesepmrg)), ]
m2 <- glmer(formula = birth ~ treated*experiment + factor(age) + (1|OID) + factor(decade)
+ factor(j) + married,
family = binomial(link ="logit"), data = datapp_rem)
datapp$decade <- 0
datapp$decade[datapp$year == 1930  |datapp$year ==1931 |datapp$year ==1932 |datapp$year ==1933
|datapp$year == 1934  | datapp$year ==1935 |datapp$year ==1936
|datapp$year ==1937 | datapp$year == 1938 |datapp$year == 1939] <- "30s"
datapp$decade[datapp$year == 1940  |datapp$year ==1941 |datapp$year ==1942 |datapp$year ==1943
|datapp$year == 1944  | datapp$year ==1945 |datapp$year ==1946
|datapp$year ==1947 | datapp$year == 1948 |datapp$year == 1939] <- "40s"
datapp$decade[datapp$year == 1950  |datapp$year ==1951  |datapp$year ==1952 |datapp$year ==1953
|datapp$year == 1954  | datapp$year ==1955 |datapp$year ==1956
|datapp$year ==1957 | datapp$year == 1958 |datapp$year == 1959] <- "50s"
datapp$decade[datapp$year == 1960  |datapp$year ==1961  |datapp$year ==1962 |datapp$year ==1963
|datapp$year == 1964  | datapp$year ==1965 |datapp$year ==1966
|datapp$year ==1967 | datapp$year == 1968 |datapp$year == 1969] <- "60s"
datapp$decade[datapp$year == 1970  |datapp$year ==1971 |datapp$year ==1972 |datapp$year ==1973
|datapp$year == 1974  | datapp$year ==1975 |datapp$year ==1976
|datapp$year ==1977] <- "70s"
#remove the households where we have missing information about the length of previous marriage,
#and try with married dummy
datapp_rem <- datapp[-which(!is.na(datapp$datesepcl) | !is.na(datapp$datesepmrg)), ]
m2 <- glmer(formula = birth ~ treated*experiment + factor(age) + (1|OID) + factor(decade)
+ factor(j) + married,
family = binomial(link ="logit"), data = datapp_rem)
stargazer(m2)
datapp_rem$j[datapp_rem$j > 4] <- 4
m2 <- glmer(formula = birth ~ treated*experiment + factor(age) + (1|OID) + factor(decade)
+ factor(j) + married,
family = binomial(link ="logit"), data = datapp_rem)
stargazer(m2)
m2 <- glmer(formula = birth ~ treated*experiment + age1519 + age2024 + age2429
+ age3035 + age3540 + (1|OID) + factor(decade)
+ factor(j) + married,
family = binomial(link ="logit"), data = datapp_rem)
m2 <- glmer(formula = birth ~ treated*experiment + age1519 + age2024 + age2429
+ age3034 + age3540 + (1|OID) + factor(decade)
+ factor(j) + married,
family = binomial(link ="logit"), data = datapp_rem)
m2 <- glmer(formula = birth ~ treated*experiment + age1519 + age2024 + age2429
+ age3034 + age3539 + age4044 + (1|OID) + factor(decade)
+ factor(j) + married,
family = binomial(link ="logit"), data = datapp_rem)
stargazer(m2)
?isSingular
isSingular(m2)
datapp$bef70 = 0
datapp$FAMNUM <- as.factor(datapp$FAMNUM)
for (i in levels(datapp$FAMNUM)){
s <- sum(datapp[datapp$FAMNUM == i & datapp$year < 1970, "birth"])
datapp$bef70[datapp$FAMNUM == i == i] <- s
}
datapp$ifchbef70 = 0
datapp$ifchbef70[basepaypanel$bef70 != 0] <- 1
datapp$bef70 = 0
datapp$FAMNUM <- as.factor(datapp$FAMNUM)
for (i in levels(datapp$FAMNUM)){
s <- sum(datapp[datapp$FAMNUM == i && datapp$year < 1970, "birth"])
datapp$bef70[datapp$FAMNUM == i == i] <- s
}
for (i in levels(datapp$FAMNUM)){
s <- sum(datapp[datapp$FAMNUM == i && datapp$year < 1970, "birth"])
datapp$bef70[datapp$FAMNUM == i] <- s
}
datapp$ifchbef70 = 0
datapp$ifchbef70[basepaypanel$bef70 != 0] <- 1
length(datapp$ifchbef70 == 0)
datapp$bef70 = 0
datapp$FAMNUM <- as.factor(datapp$FAMNUM)
datapp$bef70[datapp$birth == 1 & datapp$year < 1970] <- 1
for (i in levels(datapp$FAMNUM)){
s <- sum(datapp[datapp$FAMNUM == i, "bef70"])
datapp$bef70[datapp$FAMNUM == i] <- s
}
datapp$ifchbef70 = 0
datapp$ifchbef70[basepaypanel$bef70 != 0] <- 1
length(datapp$ifchbef70 == 0)
datapp$ifchbef70 = 0
datapp$ifchbef70[basepaypanel$bef70 != 0] <- 1
length(datapp$ifchbef70 == 0)
datapp$ifchbef70[datapp$bef70 != 0] <- 1
length(datapp$ifchbef70 == 0)
datapp$ifchbef70[datapp$bef70 != 0] <- 1
length(datapp$ifchbef70 == 0)
length(datapp$ifchbef70 == 0)
length(datapp$ifchbef70 == 0)
length(datapp$ifchbef70 == 1)
length(datapp$ifchbef70 == 1)
data <- datapp[which(datapp$ifchbef70 == 0), ]
View(data)
data_rem <- datapp[-which(!is.na(data$datesepcl) | !is.na(data$datesepmrg)), ]
data_rem <- data[-which(!is.na(data$datesepcl) | !is.na(data$datesepmrg)), ]
m3 <- glmer(formula = birth ~ treated*experiment + age1519 + age2024 + age2429
+ age3034 + age3539 + age4044 + (1|OID) + married,
family = binomial(link ="logit"), data = data_rem)
stargazer(m3)
m3 <- glmer(formula = birth ~ treated*experiment + factor(age) + (1|OID) + married,
family = binomial(link ="logit"), data = data_rem)
stargazer(m3)
m3 <- glmer(formula = birth ~ treated*experiment + factor(age) + married,
family = binomial(link ="logit"), data = data_rem)
m1 <- glmer(formula = birth ~ treated*experiment + factor(age) + (1|OID) + factor(year)
+married,
family = binomial(link ="logit"), data = datapp)
View(data_rem)
datapp_rem <- datapp[-which(!is.na(datapp$datesepcl) | !is.na(datapp$datesepmrg)), ]
m1 <- glmer(formula = birth ~ treated*experiment + factor(age) + (1|OID) + factor(year)
+married,
family = binomial(link ="logit"), data = datapp_rem)
stargazer(m1)
View(data_rem)
bwplot(data_rem$age)
data_rem$ov40 <- 0
data_rem$ov40[data_rem$age4044 == 1 | data_rem$age4550 == 1] <- 0
m3 <- glmer(formula = birth ~ treated*experiment + age1519
+ age2024 + age2429 + age3034 + age3539 + (1|OID) + married,
family = binomial(link ="logit"), data = data_rem)
stargazer(m3)
m3 <- glmer(formula = birth ~ factor(plan) + age1519
+ age2024 + age2429 + age3034 + age3539 + (1|OID) + married,
family = binomial(link ="logit"), data = data_rem)
stargazer(m3)
m3 <- glmer(formula = birth ~ factor(plan) + age1519
+ age2024 + age2429 + age3034 + age3539 + (1|OID),
family = binomial(link ="logit"), data = data_rem)
stargazer(m3)
m3 <- glmer(formula = birth ~ age1519
+ age2024 + age2429 + age3034 + age3539 + (1|OID),
family = binomial(link ="logit"), data = data_rem)
stargazer(m3)
length(levels(data_rem$FAMNUM))
length(levels(datapp$FAMNUM))
length(levels(basepay$FAMNUM))
datapp <- data_personperiod[(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
length(levels(datapp$FAMNUM))
datapp <- data_personperiod[(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
library("compareGroups")
library("data.table")
library("gtools")
library("haven")
library("dplyr")
library("tidyr")
library("tidyverse")
library("lubridate")
library("data.table")
library("foreign")
library("haven")
library("quantmod")
library("zoo")
library("plm")
library("gplots")
library("stargazer")
library("lfe")
library("Hmisc")
library("readxl")
library("naniar")
library("strex")
library(devtools)
library(survival)
library(pltesim)
library(informR)
library(frailtypack)
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
datapp <- data_personperiod[which(data_personperiod$FAMNUM %in% basepay$FAMNUM),]
View(datapp)
saveRDS(datapp, "datapp.rds")
#decades instead of years
datapp$decade <- 0
datapp$decade[datapp$year == 1930  |datapp$year ==1931 |datapp$year ==1932 |datapp$year ==1933
|datapp$year == 1934  | datapp$year ==1935 |datapp$year ==1936
|datapp$year ==1937 | datapp$year == 1938 |datapp$year == 1939] <- "30s"
datapp$decade[datapp$year == 1940  |datapp$year ==1941 |datapp$year ==1942 |datapp$year ==1943
|datapp$year == 1944  | datapp$year ==1945 |datapp$year ==1946
|datapp$year ==1947 | datapp$year == 1948 |datapp$year == 1939] <- "40s"
datapp$decade[datapp$year == 1950  |datapp$year ==1951  |datapp$year ==1952 |datapp$year ==1953
|datapp$year == 1954  | datapp$year ==1955 |datapp$year ==1956
|datapp$year ==1957 | datapp$year == 1958 |datapp$year == 1959] <- "50s"
datapp$decade[datapp$year == 1960  |datapp$year ==1961  |datapp$year ==1962 |datapp$year ==1963
|datapp$year == 1964  | datapp$year ==1965 |datapp$year ==1966
|datapp$year ==1967 | datapp$year == 1968 |datapp$year == 1969] <- "60s"
datapp$decade[datapp$year == 1970  |datapp$year ==1971 |datapp$year ==1972 |datapp$year ==1973
|datapp$year == 1974  | datapp$year ==1975 |datapp$year ==1976
|datapp$year ==1977] <- "70s"
data_rem$yfirstch <- data_rem$year[data_rem$event_1 == 1]
#Adding the no child dummy for all months until the first child birth
data_rem$yfirstch <- 0
data_rem$yfirstch <- data_rem$year[data_rem$event_1 == 1]
data_rem$yfirstch <- data_rem$year[data_rem$event_1 == 1]
data_rem$yfirstch <- data_rem$year
data_rem$yfirstch <- 0
data_rem$yfirstch[data_rem$event_1 == 1] <- data_rem$year
data_rem$tot = 0
for (i in levels(data_rem$FAMNUM)){
s <- sum(data_rem[data_rem$FAMNUM == i, "yfirstch"])
data_rem$tot[data_rem$FAMNUM == i] <- s
}
data_rem <- data_rem[-which(data_rem$year > data_rem$tot), ]
m3 <- glmer(formula = birth ~ age1519
+ age2024 + age2429 + age3034 + age3539 + (1|OID),
family = binomial(link ="logit"), data = data_rem)
stargazer(m3)
m4545 <- brglm(formula = birth ~ treated*experiment + age + factor(OID),
data = data_rem)
stargazer(m4545)
m4545 <- brglm(formula = birth ~ treated*experiment + factor(age) + factor(OID),
data = data_rem)
stargazer(m4545)
View(basepay)
basepay$if_birth[basepay$FAMNUM == 14324] <- 0
rmula
rmula
reg1 <- glm(formula = birth ~ treated + FSI + incbracket
, family = binomial(link = "logit"), data = basepay)
summary(reg1)
reg2 <- glm(formula = birth ~ plan_1 + plan_2 + plan_3 + plan_4 +
plan_5 + plan_7 + plan_8 +
FSI + incbracket, family = binomial(link = "logit"), data = basepay)
summary(reg2)
reg3 <- glm(formula = birth ~ treated + SH + age1519 + age2024 + age2429 +
age3034 + age3539 + age4044 + age4550 + FSI  + incbracket  +
chout + if_birth9,
family = binomial(link = "logit"), data = basepay)
summary(reg3)
reg4 <- glm(formula = birth ~ plan_1 + plan_2 + plan_3 + plan_4 +
plan_5 + plan_7 + plan_8 + DH + age1519 + age2024 + age2429 +
age3034 + age3539 + age4044 + age4550  +
FSI   + incbracket +
chout + if_birth9, family = binomial(link = "logit"), data = basepay)
summary(reg4)
reg5 <- glm(formula = birth ~ treated + DH + age1519 + age2024 + age2429 +
age3034 + age3539 + age4044 + age4550 + FSI + NumChild  + incbracket  +
chout + if_birth9 + changeDHSH + changeSHDH + NumAdults,
family = binomial(link = "logit"), data = basepay)
summary(reg5)
reg6 <- glm(formula = birth ~ plan_1 + plan_2 + plan_3 + plan_4 +
plan_5 + plan_7 + plan_8 + DH + age1519 + age2024 + age2429 +
age3034 + age3539 + age4044 + age4550  +
FSI + NumChild  + incbracket +
chout + if_birth9 + changeDHSH + changeSHDH + NumAdults, family = binomial(link = "logit"), data = basepay)
summary(reg6)
reg7 <- glm(formula = birth ~ treated + DH + age1519 + age2024 + age2429 +
age3034 + age3539 + age4044 + age4550 + FSI + NumChild  + incbracket  +
yrschf +
chout + if_birth9, family = binomial(link = "logit"), data = basepay)
summary(reg7)
# add changes in the household composition and number of adults
reg9 <- glm(formula = birth ~ treated + DH + age1519 + age2024 + age2429 +
age3034 + age3539 + age4044 + age4550 + FSI + NumChild  + incbracket  +
yrschf +
chout + if_birth9
+ changeDHSH + changeSHDH + NumAdults, family = binomial(link = "logit"), data = basepay)
summary(reg9)
